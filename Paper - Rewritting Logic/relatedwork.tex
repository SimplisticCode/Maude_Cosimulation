\section{Related Work}\label{sc:related}
The study of semantics and verification of co-simulation algorithms is presented in \cite{Gomes2019c,Gomes2019a,Broman2013}. 
The paper \cite{Gomes2019c} describes a formalization of an FMI-based co-simulation scenario where several correctness criteria are placed on the co-simulation algorithm to generate and verify a co-simulation algorithm. 
Furthermore, this paper extends their work by treating co-simulation scenarios subject to algebraic loops and adaptive steps.
Thule et al. \cite{Thule_2018} studied how a co-simulation scenario's characteristics can be used to choose the correct simulation strategy for a given co-simulation algorithm. In \cite{thrane2021}, algorithms of complex scenarios are described, but this paper lacks the feature to verify the correctness of algorithms for complex scenarios.

Broman et al. describe in \cite{Broman2013} an approach to achieve deterministic co-simulation results by placing constraints on the co-simulation scenario to avoid algebraic loops. 
They also propose a generic master algorithm for handling step negotiation. 
However, such generic algorithms do not consider other constraints on the SUs like reactive inputs or algebraic loops. This paper deals with all these constraints.

Formal methods have previously been successfully used in the area of co-simulation \cite{Amalio2016,sampaio_behavioural_2016,cerone_formalising_2018}.
Am√°lio et al.\ \cite{Amalio2016} study how connections between simulation units can be formalized. They investigate how different formal tools can detect algebraic loops to obtain a deterministic co-simulation result. 
Cavalcanti et al.\ \cite{sampaio_behavioural_2016} claim to provide the first behavioral semantics of FMI. The paper shows how to prove essential properties of master algorithms, like termination and determinism. It also shows that the example provided in the FMI standard is not a valid algorithm. The paper \cite{cerone_formalising_2018} by Zeyda et al. formalizes models and proofs about co-simulation in Isabelle/UTP, illustrated by an industrial case study from the railway sector. 
However, their approach does not cover complex scenarios, unlike ours.

Nyman et al. in \cite{jensen_integrating_2017} examine how UPPAAL can analyze controller-based systems with FMUs and a master algorithm modeled in UPPAAL. UPPAAL was used to verify the properties of the controller used in the co-simulation. Palmieri et al. in \cite{palmieri2019framework} have used UPPAAL to provide sound guarantees on the interleaving between a graphical user interface and a generic FMI master algorithm. 
Our approach is more generic and relies on a parameterized template approach applied to arbitrary co-simulation scenarios subject to step negotiation and algebraic loops.

\simon{Add references to synthesizing papers, verification paper}